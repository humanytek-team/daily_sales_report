<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <template id="report_sales">
            <t t-call="report.html_container">
                <t
                    t-call="daily_sales_report.report_sales_document"
                    t-lang="user.partner_id.lang"/>
            </t>
        </template>

        <!-- Translatable template -->
        <template id="report_sales_document">
            <t t-set="docs" t-value="docs.with_context({'lang':user.partner_id.lang})" />
            <t t-call="report.external_layout">

                <div class="page" style="font-size:16px;">


                    <div class="row text-right">
                        <strong>Generated:</strong>
                        <span t-esc="data['datetime']" />
                    </div>

                    <div class="row">

                    <div class="col-xs-7">
                    <div class="row">
                        <strong>Warehouse:</strong>
                        <span t-field="docs[0].warehouse_id.name" />
                    </div>

                    <div class="row">
                        <strong>User:</strong>
                        <span t-field="user.name" />
                    </div>

                    <div class="row">
                        <strong>Total sales of the day:</strong>
                        <span t-esc="data['sales_total']" />
                    </div>

                    <div class="row">
                        <strong>Total payments:</strong>
                        <span t-esc="data['payments_done_total']" />
                    </div>

                    <div class="row">
                        <strong>Date:</strong>
                        <span t-esc="data['date']" />
                    </div>

                    <hr />
                    <div class="row">
                        <div class="col-xs-3">
                            <strong>
                            Invoices
                            <span class="badge">
                                    <span t-esc="data['count_total_sale_orders_invoices']" />
                            </span>
                            </strong>
                        </div>

                        <div class="col-xs-3 text-right">
                            <span t-esc="data['sales_total']" />
                        </div>

                        <div class="col-xs-3 text-right">
                            <span t-esc="data['total_customer_refund']" />
                        </div>

                        <div class="col-xs-3 text-right">
                            <span t-esc="data['sales_total_minus_customer_refund']" />
                        </div>
                    </div>

                    <div
                        class="row"
                        t-foreach="data['pay_methods_ids']"
                        t-as="pay_method_id"
                        style="font-size: 13px;">

                        <div class="col-xs-3" style="padding-left:20px;">
                            <strong>
                            <span
                                t-esc="data['pay_methods_names_by_id'][pay_method_id]" />
                            <span class="badge">
                                <span t-esc="data['count_total_invoices_by_pay_method_id'][pay_method_id]" />
                            </span>
                            </strong>
                        </div>

                        <div class="col-xs-3 text-right">
                            <span
                                t-esc="data['total_invoices_by_pay_method_id'][pay_method_id]" />
                        </div>

                    </div>

                    <div class="row" style="font-size: 13px;">

                        <div class="col-xs-3" style="padding-left:20px;">
                            <strong>
                            Customer Refund
                            <span class="badge">
                                <span t-esc="data['count_sale_orders_invoices_out_refund']" />
                            </span>
                            </strong>
                        </div>

                        <div class="col-xs-3 col-xs-offset-3 text-right">
                            <span
                                t-esc="data['total_customer_refund']" />
                        </div>

                    </div>

                    </div>

                    <div class="col-xs-5 mt32 mb32">
                    <div
                        class="row"
                        t-foreach="data['pay_methods_ids']"
                        t-as="pay_method_id"
                        style="font-size: 14px;">

                        <div class="col-xs-4">
                        <span
                            t-esc="data['pay_methods_names_by_id'][pay_method_id]" />
                        </div>
                        <div class="col-xs-4  text-right">
                        <span
                            t-esc="data['total_invoices_by_pay_method_id'][pay_method_id]" />
                        </div>
                        <div
                            class="col-xs-4 text-right"
                            t-if="data['total_invoices_credit_by_pay_method_id'][pay_method_id] > 0">
                            <span t-esc="data['total_invoices_credit_by_pay_method_id'][pay_method_id]" />
                        </div>
                    </div>
                    <hr style="margin-top:0; margin-bottom:0;"/>
                    <div
                        class="row"
                        style="font-size: 14px;">
                        <div class="col-xs-4">
                            Total Credit
                        </div>
                        <div class="col-xs-4 col-xs-offset-4  text-right">
                                <span
                                    t-esc="data['credit_total']" />
                        </div>
                    </div>

                    <div class="row" style="font-size: 14px;">
                        <div class="col-xs-4">
                            Total Sales
                        </div>
                        <div class="col-xs-4 text-right">
                            <strong>
                        <span
                            t-esc="data['sales_total']" />
                        </strong>
                        </div>
                    </div>

                    </div>
                    </div>

                    <hr/>
                    <h2>Breakdown of invoices by payment method</h2>
                    <hr/>

                    <div
                        class="row mt32 mb32"
                        t-foreach="data['pay_methods_ids']"
                        t-as="pay_method_id">

                        <div class="row">
                            <div class="col-xs-11">
                            <strong>
                                <t t-esc="data['pay_methods_names_by_id'][pay_method_id]" />
                            </strong>
                        </div>
                            <div class="col-xs-1">
                            <span
                                class="text-right"
                                t-esc="data['total_invoices_by_pay_method_id'][pay_method_id]" />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-xs-10 col-xs-offset-1">
                            Total Invoices
                            </div>
                            <div class="col-xs-1">
                            <span
                                class="text-right"
                                t-esc="data['total_invoices_by_pay_method_id'][pay_method_id]" />
                            </div>
                        </div>

                        <div
                            class="row"
                            t-foreach="data['invoices_by_pay_method_id'][pay_method_id]"
                            t-as="invoice">

                            <div
                                class="col-xs-3 col-xs-offset-1"
                                style="padding-left:50px;">
                            <span
                                t-esc="invoice['move_name']" />
                            </div>
                            <div class="col-xs-4">
                            <span
                                t-esc="invoice['customer']" />
                            </div>
                            <div
                                class="col-xs-4 text-right"
                                style="padding-right:31px;">
                            <span
                                t-esc="invoice['amount_total']" />
                            </div>

                        </div>

                    </div>

                </div>

            </t>
        </template>

    </data>
</odoo>
